# 比特币使用

### 目录
- [站点使用](#站点使用)
- [查看创世区块](#查看创世区块)
- [比特币客户端（钱包）](#比特币客户端钱包)
  - [1.冷钱包](#1-冷钱包)
  - [2.热钱包](#2-热钱包)
  - [3.冷热钱包对比](#3-冷热钱包对比)
  - [4.桌面钱包和移动钱包](#4-桌面钱包和移动钱包)
  - [5.轻钱包和全节点钱包](#5-轻钱包和全节点钱包)
  - [6.使用钱包注意](#6-使用钱包注意)
- [获取比特币](#获取比特币)
- [交易比特币](#交易比特币)
---

## 站点使用

https://bitcoin.org  
比特币官网

https://bitcointalk.org  
比特币知名论坛

https://www.blockchain.com/explorer  
英国加密货币公司，前身是blockchain.info, 其主要产品是其加密货币钱包，交易所，区块浏览器和机构市场产品。
通过这个网站可以查询到比特币实时大盘，以及所有历史区块和其中的交易记录。除了比特币，还支持市场上流行的大多数加密货币。

https://bitinfocharts.com  
加密货币数据网站，展示了各种加密货币当前的已发行货币数量、币价、市场总价、24h交易量、全网难度、全网算力(Hashrate)、挖矿收益、top富人榜、区块链账本大小，
以及项目代码的迭代信息等。还支持查询某个**地址、区块、交易**的详细信息。

https://www.coinwarz.com/mining/bitcoin/hashrate-chart  
CoinWarz 为用户提供有关可用于采矿或交易的各种加密货币的盈利能力的信息。站内还提供了比特币全网难度、全网算力的历史变化记录图表。

## 查看创世区块

它是指区块链加密货币的第一个区块，也叫genesis block，访问 https://www.blockchain.com/explorer/blocks/btc/0

<img src="./images/bitcoin_genesis_block.jpg" height="850" width="1100">

在上图中可以看到一个区块的所有详细信息，如区块hash、区块高度、区块大小(285B)和区块产生时间等。

## 比特币客户端（钱包）
也可以叫做数字货币钱包，它可以管理你的账户私钥，主要用途是用来接收或向他人转账比特币。数字货币已经发展多年，钱包技术经过多次迭代也发展出不同的版本，
如硬件钱包（离线钱包）、在线钱包、冷钱包/热钱包、桌面/移动钱包。需要明确的是，冷钱包/热钱包才是大分类，而硬件钱包和在线钱包、以及桌面/移动钱包只是大分类下的一种形式。
另外，还有浏览器插件钱包（属于热钱包），一般在电脑浏览器端使用。  

此外，还有轻钱包（Simplified Payment Verification,SPV）的概念，它的相对概念是全节点钱包、中心化钱包。

### 1. 冷钱包
是用于存储加密货币私钥地址的离线钱包。其功能是将私钥存储在不联网的硬件设备中，因此很安全。不联网的硬件设备可以是硬件钱包，
也可以是装有钱包软件但不联网的电子设备，如电脑、手机、U盘等。  

**硬件钱包**  
是用于存储加密资产私钥地址的专用电子设备，其功能就是将私钥存储在内部的芯片内，永远不会将设备直接联网，安全性很高。
>目前市面上的多数硬件钱包在对外转账时仍旧需要通过蓝牙/USB、二维码、TF卡和NFC等方式连接到手机或电脑中的配套app。其中二维码、TF卡和NFC的连接方式更好，因为使用时它们建立的是一次性连接，
> 可以将攻击面降到最小。而对于蓝牙和USB，虽然连接时间短暂，但这在这段「间接联网」的过程中也是非常危险的。
> 硬件钱包对外转账的过程本质上是生成交易信息后再使用私钥签名，然后将交易明文和签名广播到网络中等待矿工确认。
> 
> 对于收款场景，只需通过硬件钱包显示屏出示钱包地址或二维码即可，过程无需连接联网app。

目前市面上支持比特币的硬件钱包较多，这里列出几个用户较多的品牌，如Ledger、Trezor、KeepKey、OPendime、库神钱包(中国)。

### 2. 热钱包
和冷钱包相反，热钱包是通过联网存储的钱包。  
热钱包是指互联网能够访问你私钥的钱包，热钱包往往是在线钱包的形式，使用热钱包时，最好在不同平台设置不同的密码。且开启二次认证以确保资产安全。
一般而言，普通散户用得比较多的是热钱包，因为使用方便。而大户才会用冷钱包，因为资产庞大，预防黑客入侵的风险。
>使用交易所账户交易是一种常见的交易方式，而它的危险之处就在于交易所掌握了用户的私钥和助记词，用户钱包安全完全依赖交易所。
> 近年来交易所被攻击或一夜间卷款跑路导致大量用户损失资产的新闻不绝于耳。

### 3. 冷热钱包对比
安全方面，热钱包不如冷钱包，联网功能使得热钱包在安全性方面稍显逊色。但如果从便携方面考虑，联网状态下的热钱包可以随时进行资产交易，使用体验更加方便快捷。

### 4. 桌面钱包和移动钱包
其实就是在电脑上/手机上运行的客户端钱包，也属于在线钱包的一种。  
- 主流的桌面钱包有：Bitcoin Core，Atomic Wallet，BitPay，Electrum和Exodus等；  
- 主流的移动钱包有：欧易OKx、Tokenall、Blockchain、Coinbase、imtoken等。

### 5. 轻钱包和全节点钱包
#### 5.1 轻钱包  
轻钱包(SPV)是“Simplified Payment Verification”（简单支付验证）的缩写。指的是不加载全部账本的钱包，这类钱包只加载所有的block header，
然后验证某一笔交易的hash是否在其中即可验证某一笔支付是否完成。它的优点是轻量，占用空间小，但依赖网络中的其他全节点，属于去中心化钱包。  

#### 5.2 全节点钱包
轻钱包只具有「支付验证」的功能，而没有「交易验证」的功能。「交易验证」是一个矿工节点的作用，矿工挖矿本质上是先下载整条最长链上的账本信息到本地，
然后从网络中收集交易并**验证**和打包它们到区块的过程，其中的验证指的就是交易验证，这个验证过程包含遍历整个账本以确认转账方确实包含交易所需的货币金额。

如上所述，包含了完整账本信息的钱包就是全节点钱包，它和矿工的区别是它不挖矿。优点是交易确认最快，也最安全。全节点钱包也是最早出现的钱包版本。

#### 5.3 中心化钱包
在交易所创建的在线钱包就是中心化钱包，它不依赖去中心化网络，而是通过交易所服务器接口查询账户和交易信息。
- 中心化钱包的优点是使用方便，一个账户管理多个币种，即使忘记密码也能通过注册信息找回。
- 中心化钱包的缺点是资产所有权不在用户手中，因为私钥管理在平台手中，平台随时可以限制账户的交易和提现。（不过部分交易所也将私钥告知用户，但即便如此，平台也掌握了用户私钥）

### 6. 使用钱包注意
#### 6.1 备份好私钥和助记词
对于钱包的安全管理，一定要做好私钥或助记词的离线备份及存储，忘记它你将永远无法找回这个账户。切记助记词和私钥一定不要截图存在手机里或者在线保存在云盘中，不要复制粘贴收藏在社交平台上，也不要通过网络传输“私钥，助记词，密码。

#### 6.2 不要下载来历不能的软件
不要随便下载来历不明的软件，特别是加密货币资产相关的，下载软件一定要通过官网跳转下载。假如你在这些途径输入了私钥，从技术上来说，很容易就能获取。

#### 6.3 不要连接公共WiFi
若你使用在线钱包，请尽量不要连接公共WiFi，否则也可能造成你的数据泄露。


## 获取比特币
有几种途径可以获取：
- 接受其他人的转账
- 挖矿：购买专业矿机，加入矿池，挖矿成功后获得比特币奖励。但是主流币的挖矿门槛越来越高
- 从比特币交易所购买。如火币、币安、Coinbase等

## 交易比特币
这里在 https://electrum.org/#download 下载 electrum 轻钱包进行演示，笔者电脑是macOS，Windows系统请[参考此贴](https://www.jinse.com/news/blockchain/1019059.html) 。

### 1. 将钱包连接到测试网
在mac上双击.dmg安装包将app拖到应用程序目录，然后通过终端执行命令：`open -n /Applications/Electrum.app --args --testnet`

<img src="./images/electrum_wallet_1.jpg" height="380" width="530">

如图所示，点击下一步（名字不重要，可以命名为钱包1），选择标准钱包，下一步， 选择创建新的密语种子(助记词)，下一步，复制密语种子到你的记事本，下一步，
粘贴密语种子通过验证，下一步，输入密码用来加密存储本地钱包（重点是助记词），即可创建钱包，然后看到下图

<img src="./images/electrum_wallet_testnet.jpg" height="380" width="730">

### 2. 获取测试网账户的比特币
首先，通过钱包获取收款地址，点击【接收】，输入请求的金额，大于1就行，点击创建请求，选择右侧【地址】，右下角左键复制地址

<img src="./images/electrum_wallet_req.jpg" height="380" width="730">

接下来，访问免费发币的测试网 https://coinfaucet.eu/en/btc-testnet/ ，输入框右键粘贴地址，点击按钮【Get bitcoins!】

<img src="./images/electrum_wallet_input_addr.jpg" height="200" width="800">

不出意外的话，你就可以看到下图所示的效果，表示交易发起成功，等待网络确认。注意，这里的金额并不是由我们决定的

<img src="./images/electrum_wallet_got_coin.jpg" height="210" width="750">

等几分钟后，交易确认完成，在【历史】菜单栏下可见交易记录，左下角余额从开始的红色变成绿色，红色表示未确认，
这里显示单位是mBTC，1BTC=1000mBTC，1mBTC = 100,000 satoshi，后者是BTC最小单位

<img src="./images/electrum_wallet_tx_acked.jpg" height="410" width="750">

>需要注意的是：该站点对IP进行限制，每12h仅能使用一次转账功能。

### 3. 转出比特币
首先我们需要获取收款方地址，这里我们直接将BTC转回给原地址。右键【历史】中的交易记录，点击【查看交易】，如下图

<img src="./images/electrum_wallet_tx_detail.jpg" height="410" width="800">

图中输出标记的位置就是原转账方地址，这里是根据地址后面的金额判断出来的，显然金额18前面是我们的地址，那剩余的钱必然转回原地址。
当然，这里也可以看到右侧提示绿色标记为收款地址，根据这一点也能看出来。那么复制该地址作为我们的收款方，然后在【发送】栏中输入交易相关信息。
>注意：不要复制【输入】框中的字符串作为收款地址，因为它并不是一个有效收款地址。转账到一个无效地址会导致BTC损失，无法找回。

<img src="./images/electrum_wallet_send_btc.jpg" height="410" width="800">

点击支付，输入密码，发起转账。几分钟后，交易被确认，下图展示笔者的两笔转出交易

<img src="./images/electrum_wallet_sent_btc.jpg" height="410" width="800">

其中第二笔是支付到一个无效地址，但交易仍然能被确认，通过右键该笔交易，选择【使用区块链浏览器查看】，如下图

<img src="./images/electrum_wallet_invalid_tx.jpg" height="750" width="760">

## 比特币的公钥、私钥、「账户」地址

### 1. 安装libbitcoin-explorer工具
[libbitcoin-explorer](https://github.com/libbitcoin/libbitcoin-explorer) 是cpp写的一款cli工具，通过它可以看到比特币中各种密钥以及交易信息再不同生命周期阶段编码的样子，对于学习和理解比特币原理有很大帮助。
下面以macOS为例进行演示安装：
```
# 首先需要安装brew，这里假设你已安装
# 1. 安装依赖库
$ brew install autoconf automake libtool pkgconfig wget boost zeromq

# 2. 下载安装脚本
$ wget https://raw.githubusercontent.com/libbitcoin/libbitcoin-explorer/version3/install.sh && chmod +x install.sh

# 3. 先设置好命令行http_proxy，过程需要下载文件
$ export https_proxy=http://127.0.0.1:7890 http_proxy=http://127.0.0.1:7890 all_proxy=socks5://127.0.0.1:7890
# -- 注意raw.githubusercontent.com的域名劫持问题，如被解析到0.0.0.0或代理加速失效说明被劫持，需要修改dns，笔者使用的是114.114.114.114

# 4. 创建安装主目录，然后执行脚本(安装过程大概几分钟)
$ mkdir /Users/lei/libbitcoin-explorer
$ ./install.sh --prefix=/Users/lei/libbitcoin-explorer/prefix --build-dir=/Users/lei/libbitcoin-explorer/build \
--build-boost --build-zmq --disable-shared

# 5. 安装完成，得到可执行文件
$ lei@MacBook-Pro ~ % ./libbitcoin-explorer/prefix/bin/bx

Usage: bx COMMAND [--help]

Version: 3.7.0

Info: The bx commands are:

address-decode
address-embed
address-encode

省略...
```

TODO