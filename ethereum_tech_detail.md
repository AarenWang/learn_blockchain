# 以太坊技术细节（整理）

### 目录
TODO

## 挖矿算法POS（Proof Of Stake，权益证明）

这种挖矿方式又叫虚拟挖矿。

## 挖矿算法Casper
目前，以太坊将pow和pos算法混合使用，就成了casper协议。

## Ghost协议

TODO

## 以太坊分叉

### 软分叉
在比特币中我们解释过什么是软分叉，也就是分支链可以和主链合并的分叉行为叫做软分叉。  
通常软分叉是因为软件升级导致的。

### 硬分叉
分支链永远无法和主链合并的分叉叫做硬分叉。  
比特币的硬分叉是因为区块扩容，而以太坊的硬分叉，则是黑客攻击，也就是著名的**The DAO事件**。

### The DAO事件
The DAO就是以太坊上的一个DApp，是Decentralized Autonomous Organization（分布式自治组织）的简称。那时这个项目在以太坊上进行中众筹时，
在短短的28天内就筹集了1150万以太币，在当时价值1.49亿美元，成为有史以来最大的众筹项目。这个获得众多人看好的自治组织，由德国的以太坊创业公司
Slock.it 编写源代码，其职能被设计成为一个类似于投资基金的组织，可以由社区成员投票，授权给社区为以太坊项目提供资金。

在6月12日，创始人之一的Stephan Tual宣布，他们发现了软件中的一个“递归调用splitDAO函数”漏洞；

6月15日，the DAO上的漏洞尚未修复完成，发起攻击的合约就被创立了，令所有人都措手不及。17日，攻击正式开始；

以太坊创始人Vitalik Buterin立刻通知了中国社区，DAO遭到黑客的攻击，通过DAO上“递归调用”的漏洞，不断从the DAO 中分离出资产并建立自己的child DAO，将这些以太币转移到里面。根据当时以太币的价格，可以得出被黑客转移的以太币价值近6千万美元。

为了挽回这一局势，Buterine当机立断，发布了《紧急状态更新：关于the DAO的漏洞》的文章，解释了当时the DAO被攻击的细节，以及一个关于分叉解决方案提议。首先进行软分叉，就是修改以太坊区块链上的共识协议，使得新生成的区块获得所有节点的认同。

这是一个有效的提议，一经软分叉，所有被盗的币都将“冻结”在那个地址上。从区块高度1760000开始，所有关于the DAO以及child DAO的交易都将无效，以此来阻止黑客将以太币提出。然后，再进行一次硬分叉将这些以太币找回。

为了节省篇幅，这里省去一些内容。。。

为了拿回被盗的币，以太坊最终还是进行了分叉。7月20日，备受瞩目的以太坊硬分叉完成，中国的一个矿池成功地从这条新主链上挖到了第一个区块。而由黑客转移的，其中有价值4千万美元的以太币被成功地转移到了新的地址，也就是说，经过分叉回滚，黑客盗走的the DAO以太币，被成功“召唤”回来。

这一次分叉，无疑是力挽狂澜的壮举。然而，以太坊的分叉并没有得到所有矿工的同意，所有以太坊最终形成了两条链，一条是原来的链ETC（以太经典），一条为新分叉出的链ETH，即现在的以太坊。这两条链分别代表了不同的社区共识和价值观。

同时，这一次分叉也引发了区块链业内对以太坊的一系列争议和思考。虽然硬分叉夺回了被盗走的币，但也暴露出了这样一个问题：区块链的分叉，以及将被盗的币回滚的措施，违背了区块链不可篡改的特性。

内容节选自[知乎-The DAO：导致以太坊硬分叉的罪魁祸首](https://zhuanlan.zhihu.com/p/48575688)