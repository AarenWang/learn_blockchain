# 区块链

**狭义上**：是一种按时间顺序将数据区块以顺序相连的方式组合而成的一种链式数据结构，并以密码学方式保证的不可篡改和不可伪造的分布式账本。  
**广义上**：区块链技术是利用块链式数据结构来验证和存储数据，利用分布式节点共识机制来生成和更新数据，利用密码学方式保证数据的传输和访问安全，利用自动化脚本
代码组成的智能合约来编程和操作数据的一种全新的分布式基础架构和计算范式。

**保证数据完整性**：区块产生过程中的密码学保证了数据一旦上链确认，就难以删除和更改，只能进行查询操作，从而保障了区块数据的完整性。
**保证数据共识性**：区块产生过程中的共识机制确保了某个节点产生的新区块想要上链确认，必须得到全部节点的验证，从而保证了区块数据的共识性。
**保证系统健壮性**：区块链上的数据由各方共同存储，形成了全节点备份的分布式存储架构，从而保障了区块链系统的健壮性。

>区块链的首个应用就是比特币，其他知名区块链应用如以太坊(ETH)、小蚁(NEO)、量子(QTUM)、EOS、夸克(QKI)等。

## 公链、私链和联盟链
**公链**  
是完全去中心化的一类区块链，BTC和ETH就是。交易信息公开透明，任何人都可以交易和读取信息，也都可以加入/退出节点。私密性，无法知道参与者的真实身份。缺点是交易成本高，需要多数节点验证一笔交易。

全球十大公链：BTC，ETH（以太坊），ICP，ADA（艾达币），VET，TRX，NEO（小蚁），EOS，XTZ，ETC（以太坊经典，ETH硬分叉之前的主链）

**联盟链**  
部分去中心化，节点加入需要验证和授权，这些节点再根据共识机制协调工作。这是部分去中心化的区块链，民众可以进行查阅和交易，不过验证交易的话就需要联盟内部决定。
适用于多机构联合的场景，如供应链金融、跨境清算等。

**私链**  
私有链是对单独的个人或实体进行开放的区块链系统。系统内的每个节点的权限都需要组织来分配，对每个节点开放的数据量要视情况由组织来决定。优势是交易成本低，速度快，因为不需要每个节点验证交易，少量节点就可以完成。 其次是更好的私密性，因为读取数据的权限受限，参与者无法读取链上与自己无关的数据。（适用于需要监管的场景）
Corda，hyperledger都是私链。

**三者核心区别**  
三大类型区块链的核心区别，在于访问权限的开放程度，或者叫去中心化程度。本质上，联盟链也属于私有链，只是私有的程度不同。一般来说，去中心化程度越高、
信任和安全程度越高，交易效率则越低。  
由于联盟链和私链中的节点加入均需要认证和授权，所以它俩又称许可链。


## 从技术上介绍

区块链更像是一门**交叉学科**，结合了P2P网络技术、分布式账本、密码学、共识机制、宏观经济学、经济学博弈等等知识，构建的一个新领域——针对价值互联网的探索。

**分布式数据库**是区块链的物理载体，**区块链**是交易的逻辑载体，所有核心节点都应包含该条区块链数据的全副本。区块链按时间序列化区块，
且区块链是整个网络交易数据的主体，区块链只对添加和查询有效，对其他操作无效！

>区块链是一套协议，一组规范，而不是具体代码、项目，理解了这套协议，你可以基于现有的技术，以不同的语言去实现它。

**比喻**
- 金融业的人会说区块链是一个分布式账本，是一个分布式的银行记账系统
- 密码学者的会说区块链是使用密码学构建的去信任网络
- 码农可能会说区块链就是一个确保最终一致性的分布式数据库


## 区块链技术的迭代（1.0->2.0->3.0）

1.0时代指的是以比特币为代表的虚拟数字货币时代，特征是区块上只存储了用于数字货币交易的相关数据；同时还涌现了其他数字货币，如莱特币、点点币、瑞波币等；  
2.0指的是数字货币与智能合约相结合的时代，以太坊是其典型代表。特征是具备了虚拟机、智能合约与分布式应用（DApp），其中智能合约是关键特征；在2.0时代，人们尝试创建可共用的
区块链技术平台，并向开发者提供区块链及服务（BaaS），这使得分布式身份认证、分布式域名系统、分布式自治组织等DApp的开发变得十分容易。同时，智能合约
的部署与实施也促进了自动化交易的发展，大幅提高了交易效率，降低了交易成本。  
3.0 TODO

## 核心技术

区块链使用的p2p网络通信技术或许给了我们另外一种选择：人皆生而平等，没有谁生来就是server，就是client。每个节点都是平等的，既是生产者也是消费者。

有人可能会问，p2p网络就能保证不作恶，不宕机，数据不被篡改么？别急，p2p网络只是为所有节点提供了信息交换的方式。做事的还是
**共识算法和加密算法**。

### 1.分布式账本
DLT（distributed ledger technology）本质上是一种能够在网络中的多个节点上进行数据分享、复制和同步的去中心化、新型分布式数据存储技术。想对于
传统分布式存储系统，DLT特征如下：  
- **效率高**  
  传统分布式存储系统采用一种受控于某一中心机构的数据管理机制，在面对数据爆炸性增长的数据量时，面临着巨大挑战，即不得不持续性追加投资构建大型数据
中心，造成系统规模和复杂度不断推升。这不仅带来了计算、网络、存储等各种庞大资源池建设问题，也带来了严峻的系统可靠性问题。  
  而DLT基于一定的共识规则，采用多方决策、共同维护的方式进行数据存储、复制等操作。其所具有的的去中心化数据维护策略恰恰可以有效减少系统臃肿负担，同时
在某些应用场景中，甚至可以有效利用互联网中大量零散节点所沉淀的庞大资源池。
- **安全性高**  
传统分布式存储系统中的数据是受控于单一机构组织，这样的管理机制在数据可信、网络安全方面的短板已经逐渐收到人们的关注。用户无法确定自己数据是否被服务商
窃取、篡改或非法使用，在收到黑客攻击或数据泄露时无能为力。  
  在DLT中，各个节点都是各自拥有独立的、完整的数据备份，各节点之间彼此互不干涉、权限等同，通过相互之间的周期性或事件驱动的共识达成数据存储的最终
一致性。任一节点或少数集群对数据的修改，均无法对全局多数副本造成影响。换句话说，无论是服务提供商在无授权情况下的蓄意修改，还是网络黑客的恶意攻击，
均需要同时影响到分布式账本集群中的大部分节点，才能实现对数据的修改。

### 2.共识算法

最简单的解释，共识算法的最终目标就是实现**少数服从多数**！大多数人认可一件事，这件事就是事实，也就意味着如果你要去改变一个既定事实，
那么你必须伙同系统中的大多数节点陪你一起作假，在基于p2p通信的数以千计的节点中，想要伙同其他节点一起作恶，除非“大多数节点”都被统一组织（人）控制，
有共同的利益，且利益大于付出，否则不可达成。

这里“大多数节点”加了引号，因为有些算法并不是在大多数的临界点51%时就能达成共识。如**PBFT**，需要66%以上的确定节点才能达成共识。比如现在比特币网络有人就提出了这样的担心，因为大概有75%的算力被中国矿池掌控。
目前"三巨头"分别使用不同的共识算法（Consensus Algorithm）, 比特币使用工作量证明PoW（Proof of Work），以太坊即将转换为权益证明PoS（Proof of Stake），比特股使用授权权益证明DPoS（Delegated Proof of Stake）。
以上这些算法我称之为“经济学”的算法，所谓经济学的算法，是指让作弊成本可计算，且让作弊成本往往远大于作弊带来的收益，
即作弊无利可图，通过这种思想构造一个用于节点之间博弈的算法，并使之趋向一个稳定的平衡。相对应的我们还有计算机领域的
分布式一致性算法，例如Paxos、Raft，也称之为传统分布式一致性算法。  

共识算法可以分类为 **证明类、随机类、联盟类**。其中，证明类常见的有PoW和PoS，前者证明记账节点的算力，后者证明记账节点拥有系统虚拟资源的权益。随机类常见
的是通过依赖随机数字选取打包节点的Algorand和POET3。联盟类有代表委托权益证明DPoS是以民主集中式轮流获得记账权。

#### 1.PoW算法
它是BTC系统采用的共识机制，其核心思想是当一个新的区块将要加入BTC系统中时，区块链系统中的各个节点将去争相解决一个数学难题来获得该区块的记账权，
同时获得BTC给予的奖励。由于高算力节点在解决难题上会以大概率胜出，因此高算力节点将比低算力节点更有机会获得记账权并获得BTC奖励。  
在PoW算法中，破坏者如果想要否认一笔交易（实现BTC的双花），就需要拥有整个系统51%以上的算力去竞争记账权，才能让整个区块链系统将已经记账的区块作废。
由于BTC的全网算力已经达到52.76EH/s（btc.com 2019年12月14日数据）,因此任何组织获取51%以上算力几乎是不可能的，这也是BTC系统安全性所在。  
**缺点**：当人们被BTC的高价值所吸引时，就会有大量矿工加入节点间进行算力比拼，以获得记账权和比特币奖励，这需要耗费大量计算资源，导致市面上流出大量矿卡
（经过大量计算使用后的显卡），极不环保。

#### 2.PoS算法
为了解决PoW算法浪费计算资源的问题，一种新的基于权益证明的PoS算法被设计出来。它是一种依赖记账节点在网络中的经济利益的共识机制。在PoS中，记账节点依据所拥有
的代币数量和持有代币的时间来获得币权，币权越高，节点越容易解决难题，也越容易获得记账权。  
**优点**：缩短了达成共识的时间，记账效率远高于PoW。挖矿简单，无需消耗巨大算力；  
**缺点**：节点基于虚拟货币的币权获得记账权，在系统运行之初，可能会有垄断虚拟货币的现象出现，进而导致记账权的垄断。

#### 3.DPoS算法
是一种基于投票选举的共识机制。在PoS基础上加上一个限定条件——选举，每个持币者都可投票，由此产生101个代表，按照既定时间表，轮流产生区块。如果代表
没能很好行使权利（如产生区块），它们将被除名，网络会选出新的记账节点取代它们。  
**优点**：大幅缩减了参与验证和记账节点的数量，提高了效率，可以达到秒级共识验证。  
**缺点**：记账权更加集中在少数节点手里。

#### 4.PBFT算法
TODO

### 3.加密算法
说到加密算法，大多数码农都会想到诸如对称加密，非对称加密，hash, md5，des，rsa等。加密的本质其实很简单，让信息真实、隐秘的交流及存储。
真实性由数据签名保证，隐私性由数据加密实现。区块链平台现在广泛使用的算法有椭圆曲线签名算法（ECDSA）、SHA256以及ripemd160，三者的
结合使用保证了区块链在密码学层面上达到高度隐私。


### 4.智能合约
是运行在区块链上的一段经过共识的、代表合约的程序代码，在预订条件满足的情况下，能够实现合约中条款的自动强制执行，由以太坊平台首次引入。目前
以太坊与Hyperledger Fabric是较为成熟，且具有代表性的智能合约平台。  
 以太坊智能合约运行在以太坊虚拟机（EVM）中，该虚拟机为智能合约提供了一种图灵完备的脚本语言：Ethereum virtual machine code，这使得
任何人都能创建智能合约及其去中心化应用，并在其中自由定义所有权规则，交易方式和状态转换函数。以太坊智能合约包括账户、交易、Gas、日志、指令集、消息调用、
存储和代码库8个部分。该合约主要应用于公链。  
Hyperledger Fabric智能合约实质上是在验证节点上运行的分布式交易程序，用于自动执行特定的业务规则，并最终更新账本状态。该合约部署后将被打包成
docker镜像，每个节点基于该镜像启动一个新的docker容器并执行合约中的初始化方法，然后等待被外部调用。该合约具有图灵完备性，分为公开、保密和访问控制
三种类型，分别由拥有不同权限的成员发起，主要应用于联盟链，以及企业级的数字支付、金融资产管理、供应链金融等。

## 区块链应用
### 金融领域
区块链在国际汇兑、信用证、保险业务、股权登记和证券交易所等金融领域有着潜在的巨大应用价值。将区块链技术应用在金融行业中，能够省去第三方中介环节，
实现点对点的直接对接，从而在大大降低成本的同时，快速完成交易支付。

在**保险理赔**方面，保险机构负责资金归集、投资、理赔，往往管理和运营成本较高。通过智能合约的应用，既无需投保人申请，也无需保险公司批准，只要触发理赔条件，
实现保单自动理赔。

在**跨境支付**方面，该领域的痛点是到达周期长、成本高、交易透明度低。以第三方支付公司为中心，在支付过程中完成会计、结算和清算，到达周期长。
例如，跨境支付的到达周期超过三天，成本较高。没有第三方支付机构的加入，区块链具有去中介化、开放、透明、不可篡改的特点，缩短了支付周期，降低了成本，增加了交易透明度。

比如Visa推出基于区块链技术的 Visa B2B Connect，它能为机构提供一种费用更低、更快速和安全的跨境支付方式来处理全球范围的企业对企业的交易。
要知道传统的跨境支付需要等3-5天，并为此支付1-3%的交易费用。Visa 还联合 Coinbase 推出了首张比特币借记卡，花旗银行则在区块链上测试运行加密货币“花旗币”。

### 数字货币
区块链技术最广泛的运用是以比特币为代表的数字货币。近年来，数字货币发展迅速。由于分散信贷和频繁交易的特点，具有较高的交易流通价值，
可以通过开发对冲金融衍生品作为超主权货币来保持相对稳定的价格。

自比特币出现以来，数百种数字货币已经出现，围绕数字货币的生成、存储和交易形成了一个相对较大的产业链生态系统。以比特币为例，
参与者主要可分为基础设施、交易平台、ICO融资服务、区块链综合服务等。

数字货币还可以解决纸币和电子支付存在的几个问题：
- 一是纸币易匿名、伪造，存在洗钱风险
- 二是基于现有银行账户紧耦合模式的电子支付，无法满足公众**匿名支付**的需求
- 三是现有的纸币和硬币印制发行成本高、携带不便
- 使货币创造、记账、流动等数据实时采集成为可能，并在数据脱敏以后，通过大数据等技术手段进行深入分析，为货币的投放、货币政策的制定与实施提供有益的参考，
  并为经济调控提供有益的手段。与此同时，央行数字货币还能够在反洗钱、反恐融资方面提供帮助。

加密数字货币近年来成为多个国家央行的研究重点。中国央行已经在2020年发布基于区块链的数字货币DCEP，截止2022年8月，累计交易笔数3.6亿笔、金额1000.4亿元；
其他国家也相继推出自己的CBDC（Central bank digital currencies，即中央银行数字货币）

### 价值互联网
如果说现有的互联网已解决信息传播与分享的瓶颈，那么区块链要解决的就是资金、合约和数字化资产在互联网上交换、交易与转移的难题。未来20年，是信息互联网升级为价值互联网的创业潮。

### 共享经济
近两年来，滴滴与uber之间的互联网租车争夺战，将“共享经济”推到了风口浪尖。这种个人与个人之间直接共享闲置资产的方式将通过区块链更加流行。因为区块链网络作为一个去信任去中心网络，让人们摆脱了个人与个人之间的信任危机以及中心化的非市场化运作。比如法国一个去中心化的叫车平台Arade City，司机与乘客直接交易。
而有些公司现在也正在做一个共享用户闲置磁盘空间的区块链应用平台。我们相信，唯数据与空间不可辜负，基于区块链技术，可让闲置的空间存储可被信任的加密数据。数据可以是用户自己的照片视频，也可以是某组织的业务数据。

### 智能合约
智能合约也是现在很火热的一个概念。简单的说，智能合约类似于计算机语言的if语句，当一个预先编好的合约的某一条件被触发时，就自动在区块链网络中执行合约相应的合同条款，而不需人为干预。
按照这样的愿景，未来律师的职责可能会大变样，律师的职责不是裁定个人合约，而是生产智能合约模板。定制性如何，易用性如何将决定合约的价格或者律师的身价。所以才会有笑谈：不会写脚本的律师不是好的码农。

### 物联网和物流领域
区块链在物联网和物流领域也可以天然结合。通过区块链可以降低物流成本，追溯物品的生产和运送过程，并且提高供应链管理的效率。该领域被认为是区块链一个很有前景的应用方向。

### 数字存证和版权领域
通过区块链技术，可以对作品进行鉴权，证明文字、视频、音频等作品的存在，保证权属的真实、唯一性。作品在区块链上被确权后，后续交易都会进行实时记录，实现数字版权全
生命周期管理，也可作为司法取证中的技术性保障。NFT也是数字存证的一项应用。

例如，美国纽约一家创业公司Mine Labs开发了一个基于区块链的元数据协议，这个名为Mediachain的
系统利用IPFS文件系统，实现数字作品版权保护，主要是面向数字图片的版权保护应用。

### 公益领域
区块链上存储的数据，高可靠且不可篡改，天然适合用在社会公益场景。公益流程中的相关信息，如捐赠项目、募集明细、资金流向、受助人反馈等，
均可以存放于区块链上，并且有条件地进行透明公开公示，方便社会监督。

一个典型的应用案例就是LenderBot, 是 2016 年由区块链企业 Stratumn、德勤与支付服务商 Lemonway 合作推出，它允许人们通过
Facebook Messenger 的聊天功能，注册定制化的微保险产品， 为个人之间交换的高价值物品进行投保，而区块链在贷款合同中代替了第三方角色。

### 溯源、防伪与供应链方向
溯源，顾名思义就是追踪记录有形商品或无形信息的流转链条。通过对每一次流转的登记，实现追溯产地、防伪鉴证、根据溯源信息优化供应链、提供供应链金融服务等目标。
区块链技术可给**药品溯源、艺术品防伪、奢侈品防伪**等交易提供可靠支持。

### 去中心化存储方向
医疗方面，区块链最主要的应用是对**个人医疗记录的保存**，可以理解为区块链上的电子病历。目前病历是掌握在医院手上的，患者自己并不掌握，所以病人就没有
办法获得自己的医疗记录和病史情况，就像银行的帐看不到过往记录一样，对未来的就医会造成很大的困扰。如果可以用区块链技术进行保存，患者就能随时随地掌握
自己的医疗记录历史信息，以便去到任何医院就诊都可以立即出示给医生。

DNS系统，现有DNS系统是建立在一家非营利性国际机构ICANN，和集中的DNS服务器之上的，DNS访问需要通过递归服务器=>顶级域名服务器=>权威服务器进行，复杂的访问
过程很容易让用户请求被劫持到另一地址。倘若顶级域名或权威服务器遭受DDOS攻击而故障，将会影响不计其数的互联网用户上网。而使用区块链技术能够在全球数以百万
个设备上存储信息，源头上解决了中心化服务器遭受攻击而停止服务的问题，同时也具备让用户请求**免受审查**的能力，也可以让网站**免受封锁**，而凭借共识机制可以保证用户得到的地址信息是正确的，避免被
劫持到虚假网站从而遭受诈骗。目前知名的区块链DNS服务是以太坊的ENS、Handshake。


### 元宇宙
暂无介绍

## 知名开源区块链项目

### 1.超级账本（hyperledger）
超级账本（hyperledger）是Linux基金会于2015年发起的推进区块链数字技术和交易验证的开源项目，加入成员包括：荷兰银行（ABN AMRO）、埃森哲（Accenture）、IBM
等十几个不同利益体，目标是让成员共同合作，共建开放平台，满足来自多个不同行业各种用户案例，并简化业务流程。
超级账本项目很适合联盟链，私有链的构建。现在超级账本的开源代码实现Fabric由IBM主持孵化，由go语言开发，现在版本为0.6， 坑还很多，需要时间来填。

### 2.以太坊
以太坊（Ethereum）是一个运行智能合约的去中心化平台（Platform for Smart Contract），平台上的应用按程序设定运行，不存在停机、审查、欺诈、第三方
人为干预的可能。以太坊平台由 Golang、C++、Python 等多种编程语言实现。 The DAO事件让以太坊平台损失惨重，以太坊也分裂成ETC和ETH，平台的发展前景不明。

### 3.其他还有 Ethereum、Polkadot、Solana、Bitcoin、Filecoin
